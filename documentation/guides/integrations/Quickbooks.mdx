# **QuickBooks Integration**

Vayu specializes in unifying contract commercials and usage data into a single revenue management platform. QuickBooks offers a powerful way for businesses to handle key financial and operational tasks, including accounting and financial management. Integrating the two platforms ensures that your billing and revenue information is fully up to date and aligned at all times, no matter where you’re accessing it. 

Vayu integrates smoothly and swiftly with QuickBooks, offering robust two-way synchronization for your billing and revenue workflows. Not only do you achieve data consistency across platforms, you can also seamlessly automate critical finance operations.

## **Capabilities**

The Vayu-QuickBooks integration tracks failed syncs, catalogs errors, and monitors retries. On top of this, there is duplication prevention when it comes to retries, matching records by unique IDs to avoid conflicts.

The Vayu-QuickBooks integration supports two-way syncs, with certain data syncing from Vayu and other information from QuickBooks.

You are given multiple options for syncing with the integration. 

You can opt for Manual Sync on a per-invoice basis, Bulk Sync for multiple-invoice approval in a single batch, and two different options for Auto Sync. You can implement _Auto Sync by Invoice Issue Date_ or _Auto Sync on Approval_.

### **From Vayu → QuickBooks**

- **Invoice Issuance: **Syncs fixed, usage, or hybrid invoices for prepaid, post-paid, or mixed periods. Metadata includes period start/end, product lines, discounts, taxes, Vayu invoice#
- **Credit Notes:** For cancellations, refunds, overages, then reconciled/mapped to original invoice
- **Payments**: Pushes payment status (paid, partial, failed, etc.); reconciles invoices with payment records
- **Refunds: **Triggers refund issuance and sync refund metadata (amount, date, reason).
- **Customer & Contract Sync**: Links invoices to QuickBooks customers, optionally mapping Vayu contracts to Quickbooks projects, jobs, or contracts. Also syncs customer details (name, address, email, external IDs).
- **Products / Items**
  - Sync Vayu products to ERP catalog for revenue mapping.
  - Include metadata: product ID, SKU, revenue category, tax class.
- **GL Account Mapping: **Enables per-line or per-product mapping to QuickBooks chart of accounts (income, AR, tax).
- **Custom Metadata: **Syncs custom fields like Class, Department, and Tags for financial reporting or segmentation.

### **From QuickBooks → Vayu**

- **Invoice Status Updates: **Retrieves updated status (Paid, Overdue, Voided) from QuickBook to sync back into Vayu.
- **Customer & Product Metadata: **Pulls updates to customers and product definitions (e.g., class assignments, GL mappings).

## **Prerequisites & Permissions**

You’ll need the following to get started:

1. QuickBooks account
2. Vayu account
3. Permissions and Admin support

## **Connection & Setup**

To launch initial setup and integrations, please contact the Vayu support team.

- From Vayu, click **Connect to QuickBooks**.
- Sign in with your QuickBooks admin or accountant account.
- Authorize Vayu to access the required accounting data.

Once connected, Vayu will begin pulling customer and product metadata and will allow invoice syncs according to your settings.

## **Configurations**

Set up configurations by clicking on QuickBooks on the integration page. A panel with various settings will open to the right side of the page:

### **Invoices**

You have two configurations to consider for invoices with QuickBooks and Vayu.

First, choose which invoice number to use:

- ⦾ Use Vayu invoice number and override QuickBooks invoice number
- ⦾ Use QuickBooks auto-generated invoice number

Second, choose whether or not to include bank details:

- ⦾ Include
- ⦾ Don’t include

### **Field Mappings & Attribution**

- **ItemRef:** Identifies the QuickBooks product/service
- **AccountRef:** Income or AR account
- **ClassRef:** Optional segmentation fields
- **CustomerRef:** Mapped QuickBooks customer

## **Reconciliation**

### **Logs and Activity Tracking**

Vayu ensures proper versioning and reconciliation by logging all synced records with timestamps for audits. 

To do this, be sure to enable syncing on validation reports. 

All sync activity is tracked inside Vayu:

- Success and failure logs for failed syncs
- Retry attempts
- IDs of created QuickBooks transactions
- Timestamped event history
- Error reasoning/details with user-friendly explanations

These logs help finance teams quickly diagnose and correct issues.

## **Troubleshooting**

### **Common Issues and Fixes**

| **Issue**           | **Explanation**                                              | **Fix**                                                                 |
| :------------------ | :----------------------------------------------------------- | :---------------------------------------------------------------------- |
| Missing ItemRef     | A Vayu product is not mapped to a QuickBooks Product/Service | Add mapping in Vayu → retry sync                                        |
| Permission error    | QuickBooks user lacks access to invoices or items            | Reconnect using a QuickBooks admin                                      |
| Rate limit exceeded | QuickBooks Online throttles at 500 req/min                   | Vayu automatically retries; try bulk sync during lower activity periods |
| Invalid GL mapping  | The referenced account is inactive or restricted             | Update mapping to an active income or AR account                        |
| Token expired       | OAuth token revoked or expired                               | Reconnect QuickBooks in Vayu                                            |

## **QuickBooks Online**

The integration is managed by token and OAuth 2.0 authentication.

The Vayu QuickBooks integration can handle up to 500 requests/minute (including retries). It also comes replete with rich support for Chart of Accounts (COA, mapping Vayu products to QuickBook accounts) and segmentation by classes and location. 

Additionally, QuickBooks accountants use the same API under the accountant role, but with multi-client and permission nuances. 

### **Refunds**

Refunds are handled by Credit Memo and Payment reversal.

## **Quickbooks Accounting User as client**

QuickBooks accountants use the same API under the accountant role, but with multi-client and permission nuances. 

Similarly, this is managed by token access and OAuth 2.0 authentication.

## **NOTES**

## **Bi-Directional ERP Data Sync**

### **From Vayu → ERP**

1. **Invoice Issuance**
   - Sync fixed, usage, hybrid invoice types.
   - Support pre-paid, post-paid, and mixed periods.
   - Attach invoice metadata: period start/end, product lines, discounts, taxes, Vayu invoice#
2. **Credit Notes**
   - Create credit notes for cancellations, refunds, overages.
   - Map credit note to original invoice for reconciliation.
3. **Payments**
   - Push payment status (paid, partial, failed …) if captured externally.
   - Reconcile paid invoices with payment records.
4. **Refunds**
   - Trigger refund issuance and sync refund metadata (amount, date, reason).
5. **Customer & Contract Sync**
   - Sync customer details (name, address, email, external IDs).
   - Associate invoice to ERP customer/account.
   - Optionally map Vayu contracts to ERP projects, jobs, or contracts.
6. **Products / Items**
   - Sync Vayu products to ERP catalog for revenue mapping.
   - Include metadata: product ID, SKU, revenue category, tax class.
7. **GL Account Mapping**
   - Enable per-line or per-product mapping to ERP chart of accounts (income, AR, tax).
8. **Custom Metadata**
   - Sync custom fields like Class, Department, Tags for financial reporting and segmentation.

### **From ERP → Vayu**

1. **Invoice Status Updates**
   - Retrieve updated status (Paid, Overdue, Voided) from ERP to sync back into Vayu.
2. **Customer & Product Metadata**
   - Pull updates to customers and product definitions (e.g., class assignments, GL mappings).

### **Sync Timing and Triggering**

- Support multiple sync strategies - (according to existing functionality on Vayu
  - **Auto Sync** on Invoice Issue Date
  - **Auto Sync** on Approval
  - **Bulk Sync** (multi-invoice approval)
  - **Manual Sync** (per invoice)

### **Operational Functionality**

- **Retry & Error Logging - **Track failed syncs, store error reasons, allow for retries.
- **Idempotency & Conflict Avoidance -**
  - Prevent duplicate invoice creation on retries
  - Match records using unique identifiers.
- **Versioning & Reconciliation**
  - Log all synced records with timestamps for audit.
  - Enable sync validation reports (e.g., mismatched invoices, missing GL accounts).
- **Support for Multi-currency & Localization**
  - Pass currency and locale-specific metadata as needed.
- **Modular & Extensible Architecture**
  - Each ERP connector should be modular (i.e., swappable based on tenant).

## **QuickBooks Online** 

- OAuth 2.0 authentication with token refresh.
- Rich support for:
  - **Chart of Accounts** (COA): map Vayu product to income/tax/AR accounts.
  - **Classes and Locations** for segmentation.
- Invoice lines must reference:
  - ItemRef, AccountRef, ClassRef.
- Rate limits: 500 requests/minute → batch & retry logic critical.
- Sync tax codes if not using Avalara.
- Refunds handled via Credit Memo + Payment reversal.

## **Quickbooks Accounting User as client**

QuickBooks accountants use the same API under the accountant role, but with multi-client and permission nuances. Vayu must accommodate:

- OAuth by accountant across multiple clients
- Robust token management per Realm
- Early permission verification
- Per-client product/account/class mapping
- Clear audit metadata